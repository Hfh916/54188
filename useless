
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "DynamicIslandUI"
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = playerGui

local dynamicIsland = Instance.new("Frame")
dynamicIsland.Name = "DynamicIsland"
dynamicIsland.Size = UDim2.new(0, 180, 0, 55)
dynamicIsland.Position = UDim2.new(0.5, -90, 0.05, 0)
dynamicIsland.AnchorPoint = Vector2.new(0.5, 0)
dynamicIsland.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
dynamicIsland.BackgroundTransparency = 0.2
dynamicIsland.BorderSizePixel = 0
dynamicIsland.Active = true
dynamicIsland.Draggable = true  

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(1, 0)
corner.Parent = dynamicIsland

local shadow = Instance.new("UIStroke")
shadow.Color = Color3.fromRGB(0, 0, 0)
shadow.Thickness = 2
shadow.Transparency = 0.7
shadow.Parent = dynamicIsland

dynamicIsland.Parent = screenGui

local contentFrame = Instance.new("Frame")
contentFrame.Name = "Content"
contentFrame.Size = UDim2.new(1, -20, 1, -10)
contentFrame.Position = UDim2.new(0, 10, 0, 5)
contentFrame.BackgroundTransparency = 1
contentFrame.Parent = dynamicIsland

local leftSection = Instance.new("Frame")
leftSection.Name = "LeftSection"
leftSection.Size = UDim2.new(0, 40, 1, 0)
leftSection.Position = UDim2.new(0, 0, 0, 0)
leftSection.BackgroundTransparency = 1
leftSection.Parent = contentFrame

local playerIcon = Instance.new("ImageLabel")
playerIcon.Name = "PlayerIcon"
playerIcon.Size = UDim2.new(0, 30, 0, 30)
playerIcon.Position = UDim2.new(0.5, -15, 0.5, -15)
playerIcon.AnchorPoint = Vector2.new(0.5, 0.5)
playerIcon.BackgroundTransparency = 1
playerIcon.Image = "rbxassetid://3926305904"  
playerIcon.ImageRectOffset = Vector2.new(124, 364)
playerIcon.ImageRectSize = Vector2.new(36, 36)
playerIcon.ImageColor3 = Color3.fromRGB(100, 150, 255)
playerIcon.Parent = leftSection

local iconGlow = Instance.new("Frame")
iconGlow.Name = "IconGlow"
iconGlow.Size = UDim2.new(1.2, 0, 1.2, 0)
iconGlow.Position = UDim2.new(0.5, -18, 0.5, -18)
iconGlow.AnchorPoint = Vector2.new(0.5, 0.5)
iconGlow.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
iconGlow.BackgroundTransparency = 0.8
iconGlow.BorderSizePixel = 0

local glowCorner = Instance.new("UICorner")
glowCorner.CornerRadius = UDim.new(1, 0)
glowCorner.Parent = iconGlow

iconGlow.Parent = leftSection

local rightSection = Instance.new("Frame")
rightSection.Name = "RightSection"
rightSection.Size = UDim2.new(1, -45, 1, 0)
rightSection.Position = UDim2.new(0, 45, 0, 0)
rightSection.BackgroundTransparency = 1
rightSection.Parent = contentFrame

local titleText = Instance.new("TextLabel")
titleText.Name = "TitleText"
titleText.Size = UDim2.new(1, 0, 0.5, 0)
titleText.Position = UDim2.new(0, 0, 0, 0)
titleText.BackgroundTransparency = 1
titleText.Text = "在线玩家"
titleText.TextColor3 = Color3.fromRGB(200, 200, 200)
titleText.TextScaled = true
titleText.TextXAlignment = Enum.TextXAlignment.Left
titleText.Font = Enum.Font.Gotham
titleText.TextSize = 14
titleText.Parent = rightSection

local playerCountText = Instance.new("TextLabel")
playerCountText.Name = "PlayerCountText"
playerCountText.Size = UDim2.new(1, 0, 0.5, 0)
playerCountText.Position = UDim2.new(0, 0, 0.5, 0)
playerCountText.BackgroundTransparency = 1
playerCountText.Text = "0"
playerCountText.TextColor3 = Color3.fromRGB(255, 255, 255)
playerCountText.TextScaled = true
playerCountText.TextXAlignment = Enum.TextXAlignment.Left
playerCountText.Font = Enum.Font.GothamBold
playerCountText.TextSize = 18
playerCountText.Parent = rightSection

local statusIndicator = Instance.new("Frame")
statusIndicator.Name = "StatusIndicator"
statusIndicator.Size = UDim2.new(0, 6, 0, 6)
statusIndicator.Position = UDim2.new(1, -10, 0.5, -3)
statusIndicator.AnchorPoint = Vector2.new(1, 0.5)
statusIndicator.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
statusIndicator.BorderSizePixel = 0

local statusCorner = Instance.new("UICorner")
statusCorner.CornerRadius = UDim.new(1, 0)
statusCorner.Parent = statusIndicator

statusIndicator.Parent = rightSection

local statusGlow = Instance.new("Frame")
statusGlow.Name = "StatusGlow"
statusGlow.Size = UDim2.new(2, 0, 2, 0)
statusGlow.Position = UDim2.new(0.5, -6, 0.5, -6)
statusGlow.AnchorPoint = Vector2.new(0.5, 0.5)
statusGlow.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
statusGlow.BackgroundTransparency = 0.7
statusGlow.BorderSizePixel = 0

local statusGlowCorner = Instance.new("UICorner")
statusGlowCorner.CornerRadius = UDim.new(1, 0)
statusGlowCorner.Parent = statusGlow

statusGlow.Parent = statusIndicator

local function updatePlayerCount()
    local playerCount = #Players:GetPlayers()
    playerCountText.Text = tostring(playerCount) .. " 人"
    
    
    if playerCount < 5 then
        playerCountText.TextColor3 = Color3.fromRGB(255, 100, 100)  
        statusIndicator.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
        statusGlow.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
    elseif playerCount < 15 then
        playerCountText.TextColor3 = Color3.fromRGB(255, 200, 100)  
        statusIndicator.BackgroundColor3 = Color3.fromRGB(255, 200, 100)
        statusGlow.BackgroundColor3 = Color3.fromRGB(255, 200, 100)
    else
        playerCountText.TextColor3 = Color3.fromRGB(100, 200, 100)  
        statusIndicator.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
        statusGlow.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
    end
end

updatePlayerCount()

Players.PlayerAdded:Connect(updatePlayerCount)
Players.PlayerRemoving:Connect(updatePlayerCount)

local function pulseAnimation()
    local tweenInfo = TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    
    
    local iconTween = TweenService:Create(playerIcon, tweenInfo, {
        Size = UDim2.new(0, 32, 0, 32)
    })
    iconTween:Play()
    
    
    local glowTween = TweenService:Create(iconGlow, tweenInfo, {
        BackgroundTransparency = 0.6
    })
    glowTween:Play()
    
    iconTween.Completed:Connect(function()
        local iconTweenBack = TweenService:Create(playerIcon, tweenInfo, {
            Size = UDim2.new(0, 30, 0, 30)
        })
        iconTweenBack:Play()
        
        local glowTweenBack = TweenService:Create(iconGlow, tweenInfo, {
            BackgroundTransparency = 0.8
        })
        glowTweenBack:Play()
    end)
end

local function statusBreathAnimation()
    while true do
        local tweenInfo = TweenInfo.new(1.5, Enum.EasingStyle.Sine, Enum.EasingDirection.InOut)
        local tween = TweenService:Create(statusGlow, tweenInfo, {
            BackgroundTransparency = 0.9
        })
        tween:Play()
        
        wait(1.5)
        
        local tweenBack = TweenService:Create(statusGlow, tweenInfo, {
            BackgroundTransparency = 0.7
        })
        tweenBack:Play()
        
        wait(1.5)
    end
end

coroutine.wrap(statusBreathAnimation)()

Players.PlayerAdded:Connect(function()
    updatePlayerCount()
    pulseAnimation()
end)

Players.PlayerRemoving:Connect(function()
    updatePlayerCount()
    pulseAnimation()
end)

dynamicIsland.MouseEnter:Connect(function()
    local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(dynamicIsland, tweenInfo, {
        BackgroundTransparency = 0.1
    })
    tween:Play()
end)

dynamicIsland.MouseLeave:Connect(function()
    local tweenInfo = TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
    local tween = TweenService:Create(dynamicIsland, tweenInfo, {
        BackgroundTransparency = 0.2
    })
    tween:Play()
end)
